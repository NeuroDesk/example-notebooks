

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>fMRIprep &#8212; Neurodesk</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'fmriprep';</script>
    <link rel="canonical" href="https://neurodesk.github.io/example-notebooks/intro.html/fmriprep.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="#">
  
  
  
  
  
  
    <p class="title logo__title">Neurodesk</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1 current active">
                <a class="reference internal" href="#">
                    fMRIprep
                </a>
            </li>
        </ul>
        
    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://play-america.neurodesk.org/hub/user-redirect/git-pull?repo=https%3A//github.com/NeuroDesk/example-notebooks&urlpath=lab/tree/example-notebooks/books/fmriprep.ipynb&branch=main" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onJupyterHub"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="_static/images/logo_jupyterhub.svg">
  </span>
<span class="btn__text-container">JupyterHub</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/NeuroDesk/example-notebooks" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NeuroDesk/example-notebooks/edit/main/books/fmriprep.ipynb" target="_blank"
   class="btn btn-sm btn-source-edit-button dropdown-item"
   title="Suggest edit"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="btn__text-container">Suggest edit</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/NeuroDesk/example-notebooks/issues/new?title=Issue%20on%20page%20%2Ffmriprep.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/fmriprep.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>fMRIprep</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-cpu-information">Output CPU information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-fmriprep">Run fMRIprep</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fmriprep-results">fMRIprep Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t1-and-brain-mask">T1 and brain mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#surfaces">Surfaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#epi-space-to-t1-space">EPI-space to T1-space</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-mask-and-anatomical-temporal-compcor-rois">Brain mask and (anatomical/temporal) CompCor ROIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bold-summary">Bold Summary</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="fmriprep">
<h1>fMRIprep<a class="headerlink" href="#fmriprep" title="Permalink to this heading">#</a></h1>
<p><strong>Author:</strong> Steffen Bollmann</p>
<p><strong>Citation:</strong></p>
<p><strong>fMRIPrep</strong>:</p>
<ul class="simple">
<li><p>Esteban, O., Markiewicz, C.J., Blair, R.W. et al. fMRIPrep: a robust preprocessing pipeline for functional MRI. Nat Methods 16, 111–116 (2019). <a class="reference external" href="https://doi.org/10.1038/s41592-018-0235-4">https://doi.org/10.1038/s41592-018-0235-4</a></p></li>
</ul>
<p><strong>Opensource Data from OpenNeuro:</strong></p>
<ul class="simple">
<li><p>Kelly AMC and Uddin LQ and Biswal BB and Castellanos FX and Milham MP (2018). Flanker task (event-related). <a class="reference external" href="https://openneuro.org/datasets/ds000102/versions/00001">OpenNeuro Dataset ds000102</a></p></li>
<li><p>Kelly, A.M., Uddin, L.Q., Biswal, B.B., Castellanos, F.X., Milham, M.P. (2008). Competition between functional brain networks mediates behavioral variability. Neuroimage, 39(1):527-37</p></li>
</ul>
<section id="output-cpu-information">
<h2>Output CPU information<a class="headerlink" href="#output-cpu-information" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>cat /proc/cpuinfo <span class="p">|</span> grep <span class="s1">&#39;vendor&#39;</span> <span class="p">|</span> uniq
<span class="o">!</span>cat /proc/cpuinfo <span class="p">|</span> grep <span class="s1">&#39;model name&#39;</span> <span class="p">|</span> uniq
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>vendor_id	: AuthenticAMD
model name	: AMD EPYC-Rome Processor
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-fmriprep">
<h2>Run fMRIprep<a class="headerlink" href="#run-fmriprep" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load fmriprep</span>
<span class="kn">import</span> <span class="nn">module</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="k">await</span> <span class="n">module</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">&#39;fmriprep/24.1.0&#39;</span><span class="p">)</span>
<span class="k">await</span> <span class="n">module</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Lmod&#39;,
 &#39;Warning:&#39;,
 &#39;The&#39;,
 &#39;environment&#39;,
 &#39;MODULEPATH&#39;,
 &#39;has&#39;,
 &#39;been&#39;,
 &#39;changed&#39;,
 &#39;in&#39;,
 &#39;unexpected&#39;,
 &#39;ways.&#39;,
 &#39;Lmod&#39;,
 &#39;is&#39;,
 &#39;unable&#39;,
 &#39;to&#39;,
 &#39;use&#39;,
 &#39;given&#39;,
 &#39;MODULEPATH.&#39;,
 &#39;It&#39;,
 &#39;is&#39;,
 &#39;using:&#39;,
 &#39;&quot;/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/functional_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/rodent_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_registration:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/structural_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_segmentation:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/quantitative_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/workflows:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/hippocampus:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/image_reconstruction:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/data_organisation:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/electrophysiology:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/phase_processing:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/programming:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/machine_learning:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/diffusion_imaging:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/body:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/visualization:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/spectroscopy:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/quality_control:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/statistics:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/shape_analysis:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/spine:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/molecular_biology:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/bids_apps:/cvmfs/neurodesk.ardc.edu.au/neurodesk-modules/cryo_EM::&quot;.&#39;,
 &#39;Please&#39;,
 &#39;use&#39;,
 &#39;&quot;module&#39;,
 &#39;use&#39;,
 &#39;to&#39;,
 &#39;change&#39;,
 &#39;MODULEPATH&#39;,
 &#39;instead.&#39;,
 &#39;fmriprep/24.1.0&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Request a freesurfer license and store it in your homedirectory. This is just an exampe - please replace with your license id:</span>
<span class="o">!</span><span class="nb">echo</span> <span class="s2">&quot;Steffen.Bollmann@cai.uq.edu.au&quot;</span> &gt; ~/.license
<span class="o">!</span><span class="nb">echo</span> <span class="s2">&quot;21029&quot;</span> &gt;&gt; ~/.license
<span class="o">!</span><span class="nb">echo</span> <span class="s2">&quot;*Cqyn12sqTCxo&quot;</span> &gt;&gt; ~/.license
<span class="o">!</span><span class="nb">echo</span> <span class="s2">&quot;FSxgcvGkNR59Y&quot;</span> &gt;&gt; ~/.license
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># download data</span>
<span class="o">!</span>datalad install https://github.com/OpenNeuroDatasets/ds000102.git
<span class="o">!</span><span class="nb">cd</span> ds000102 <span class="o">&amp;&amp;</span> datalad get sub-08
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Clone attempt:   0%|              | 0.00/2.00 [00:00&lt;?, ? Candidate locations/s]
Enumerating: 0.00 Objects [00:00, ? Objects/s]
                                              
Counting:   0%|                               | 0.00/27.0 [00:00&lt;?, ? Objects/s]
                                                                                
Compressing:   0%|                            | 0.00/23.0 [00:00&lt;?, ? Objects/s]
                                                                                
Receiving:   0%|                             | 0.00/2.15k [00:00&lt;?, ? Objects/s]
                                                                                
Resolving:   0%|                                | 0.00/537 [00:00&lt;?, ? Deltas/s]
[INFO   ] scanning for unlocked files (this may take some time) 
[INFO   ] Remote origin not usable by git-annex; setting annex-ignore 
[INFO   ] access to 1 dataset sibling s3-PRIVATE not auto-enabled, enable with:
| 		datalad siblings -d &quot;/storage/tmp/tmp63jiwfui/ds000102&quot; enable -s s3-PRIVATE 
<span class=" -Color -Color-Bold">install</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): /storage/tmp/tmp63jiwfui/ds000102 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">dataset</span>)
Total:   0%|                                   | 0.00/67.8M [00:00&lt;?, ? Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   0%|            | 0.00/10.6M [00:00&lt;?, ? Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   0%|    | 16.4k/10.6M [00:00&lt;01:20, 131k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   0%|   | 33.4k/10.6M [00:00&lt;02:36, 67.2k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   0%|   | 50.8k/10.6M [00:01&lt;04:30, 38.8k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   1%|   | 85.6k/10.6M [00:01&lt;02:40, 65.3k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   1%|    | 120k/10.6M [00:01&lt;02:31, 68.7k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   1%|    | 138k/10.6M [00:02&lt;02:28, 70.2k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   1%|    | 155k/10.6M [00:02&lt;02:25, 71.4k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   2%|    | 173k/10.6M [00:02&lt;02:23, 72.5k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   2%|    | 190k/10.6M [00:02&lt;02:21, 73.3k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   2%|    | 225k/10.6M [00:03&lt;01:49, 94.5k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   2%|    | 242k/10.6M [00:03&lt;01:54, 90.4k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   3%|▏    | 277k/10.6M [00:03&lt;01:36, 107k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   3%|▏    | 294k/10.6M [00:03&lt;01:35, 108k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   3%|▏    | 347k/10.6M [00:03&lt;01:15, 135k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   4%|▏    | 382k/10.6M [00:04&lt;01:11, 143k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   4%|▏    | 451k/10.6M [00:04&lt;00:54, 186k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   5%|▏    | 503k/10.6M [00:04&lt;00:43, 232k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   5%|▎    | 573k/10.6M [00:04&lt;00:39, 255k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   6%|▎    | 660k/10.6M [00:04&lt;00:33, 293k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   7%|▎    | 730k/10.6M [00:05&lt;00:30, 321k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   7%|▎    | 765k/10.6M [00:05&lt;00:33, 289k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   8%|▍    | 852k/10.6M [00:05&lt;00:25, 382k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:   9%|▍    | 939k/10.6M [00:05&lt;00:24, 393k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  10%|▍   | 1.10M/10.6M [00:05&lt;00:19, 478k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  12%|▍   | 1.23M/10.6M [00:06&lt;00:18, 516k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  13%|▌   | 1.39M/10.6M [00:06&lt;00:16, 567k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  15%|▌   | 1.57M/10.6M [00:06&lt;00:14, 624k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  16%|▋   | 1.74M/10.6M [00:06&lt;00:13, 667k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  19%|▋   | 1.97M/10.6M [00:07&lt;00:11, 758k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  21%|▊   | 2.19M/10.6M [00:07&lt;00:10, 825k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  23%|▉   | 2.44M/10.6M [00:07&lt;00:09, 894k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  25%|▉   | 2.59M/10.6M [00:07&lt;00:08, 956k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  26%|█   | 2.71M/10.6M [00:07&lt;00:07, 997k Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  29%|▊  | 3.01M/10.6M [00:07&lt;00:06, 1.10M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  31%|▉  | 3.31M/10.6M [00:08&lt;00:05, 1.29M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  35%|█  | 3.69M/10.6M [00:08&lt;00:05, 1.29M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  38%|█▏ | 4.05M/10.6M [00:08&lt;00:04, 1.43M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  43%|█▎ | 4.49M/10.6M [00:08&lt;00:04, 1.51M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  47%|█▍ | 4.93M/10.6M [00:09&lt;00:03, 1.63M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  51%|█▌ | 5.41M/10.6M [00:09&lt;00:02, 1.77M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  56%|█▋ | 5.92M/10.6M [00:09&lt;00:02, 1.90M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  61%|█▊ | 6.47M/10.6M [00:09&lt;00:01, 2.05M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  67%|██ | 7.07M/10.6M [00:10&lt;00:01, 2.20M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  73%|██▏| 7.71M/10.6M [00:10&lt;00:01, 2.36M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  79%|██▍| 8.38M/10.6M [00:10&lt;00:00, 2.54M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  82%|██▍| 8.64M/10.6M [00:10&lt;00:00, 2.45M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  86%|██▌| 9.10M/10.6M [00:10&lt;00:00, 2.80M Bytes/s]
Get sub-08/a .. 8_T1w.nii.gz:  93%|██▊| 9.87M/10.6M [00:10&lt;00:00, 2.99M Bytes/s]
Total:  16%|████▏                      | 10.6M/67.8M [00:12&lt;01:08, 834k Bytes/s]
Get sub-08/f .. _bold.nii.gz:   0%|            | 0.00/28.6M [00:00&lt;?, ? Bytes/s]
Get sub-08/f .. _bold.nii.gz:   3%|    | 855k/28.6M [00:00&lt;00:04, 6.89M Bytes/s]
Get sub-08/f .. _bold.nii.gz:   6%|▏  | 1.79M/28.6M [00:00&lt;00:07, 3.59M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  10%|▎  | 2.72M/28.6M [00:00&lt;00:05, 4.36M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  13%|▍  | 3.74M/28.6M [00:00&lt;00:06, 3.90M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  17%|▌  | 4.79M/28.6M [00:01&lt;00:05, 4.30M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  20%|▌  | 5.74M/28.6M [00:01&lt;00:04, 5.25M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  25%|▋  | 7.11M/28.6M [00:01&lt;00:04, 4.37M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  29%|▉  | 8.36M/28.6M [00:01&lt;00:04, 4.67M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  34%|█  | 9.69M/28.6M [00:02&lt;00:03, 4.98M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  39%|█▏ | 11.1M/28.6M [00:02&lt;00:03, 5.29M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  43%|█▎ | 12.4M/28.6M [00:02&lt;00:02, 6.48M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  47%|█▍ | 13.6M/28.6M [00:02&lt;00:02, 6.18M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  54%|█▌ | 15.4M/28.6M [00:02&lt;00:02, 6.51M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  59%|█▊ | 17.0M/28.6M [00:03&lt;00:01, 6.72M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  65%|█▉ | 18.6M/28.6M [00:03&lt;00:01, 6.80M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  72%|██▏| 20.5M/28.6M [00:03&lt;00:01, 7.17M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  78%|██▎| 22.3M/28.6M [00:03&lt;00:00, 7.44M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  81%|██▍| 23.1M/28.6M [00:03&lt;00:00, 7.08M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  85%|██▌| 24.3M/28.6M [00:04&lt;00:00, 7.99M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  92%|██▊| 26.4M/28.6M [00:04&lt;00:00, 8.36M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  95%|██▊| 27.3M/28.6M [00:04&lt;00:00, 8.11M Bytes/s]
Get sub-08/f .. _bold.nii.gz: 100%|██▉| 28.6M/28.6M [00:04&lt;00:00, 9.03M Bytes/s]
Total:  58%|███████████████           | 39.2M/67.8M [00:17&lt;00:12, 2.22M Bytes/s]
Get sub-08/f .. _bold.nii.gz:   0%|            | 0.00/28.6M [00:00&lt;?, ? Bytes/s]
Get sub-08/f .. _bold.nii.gz:   8%|▏  | 2.32M/28.6M [00:00&lt;00:02, 12.4M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  13%|▍  | 3.68M/28.6M [00:00&lt;00:02, 10.8M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  20%|▌  | 5.77M/28.6M [00:00&lt;00:02, 9.85M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  28%|▊  | 7.95M/28.6M [00:00&lt;00:02, 9.78M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  36%|█  | 10.3M/28.6M [00:01&lt;00:01, 9.74M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  40%|█▏ | 11.4M/28.6M [00:01&lt;00:01, 8.98M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  46%|█▎ | 13.1M/28.6M [00:01&lt;00:01, 8.84M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  53%|█▌ | 15.3M/28.6M [00:01&lt;00:01, 9.02M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  58%|█▋ | 16.6M/28.6M [00:01&lt;00:01, 9.78M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  66%|█▉ | 18.8M/28.6M [00:01&lt;00:01, 9.65M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  73%|██▏| 20.9M/28.6M [00:02&lt;00:00, 9.42M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  81%|██▍| 23.1M/28.6M [00:02&lt;00:00, 9.49M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  88%|██▋| 25.2M/28.6M [00:02&lt;00:00, 9.34M Bytes/s]
Get sub-08/f .. _bold.nii.gz:  96%|██▊| 27.4M/28.6M [00:02&lt;00:00, 9.44M Bytes/s]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08/anat/sub-08_T1w.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08/func/sub-08_task-flanker_run-1_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08/func/sub-08_task-flanker_run-2_bold.nii.gz (<span class=" -Color -Color-Bold -Color-Bold-Magenta">file</span>) [from s3-PUBLIC...]
<span class=" -Color -Color-Bold">get</span>(<span class=" -Color -Color-Bold -Color-Bold-Green">ok</span>): sub-08 (<span class=" -Color -Color-Bold -Color-Bold-Magenta">directory</span>)
action summary:
  get (ok: 4)

</pre></div>
</div>
</div>
</div>
<div class="cell tag_scroll-output docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span><span class="k">bash</span>
# set up environment variables
export SUBJECTS_DIR=$PWD/fmriprep-freesurfer-dir
export APPTAINERENV_SUBJECTS_DIR=$SUBJECTS_DIR
export ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS=2 
export MPLCONFIGDIR=~/matplotlib-mpldir 

# create subjects directory
mkdir -p $SUBJECTS_DIR

# run fmriprep
fmriprep ds000102/ fmriprep-output participant \
--fs-license-file ~/.license \
--output-spaces T1w MNI152NLin2009cAsym fsaverage fsnative \
--participant-label 08 \
--nprocs $ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS \
--mem 10000 \
--skip_bids_validation \
--fs-subjects-dir $SUBJECTS_DIR \
-v
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/pathlib.py&quot;, line 1116, in mkdir
    os.mkdir(self, mode)
FileNotFoundError: [Errno 2] No such file or directory: &#39;/home/ubuntu/.cache/templateflow&#39;

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File &quot;/opt/conda/envs/fmriprep/bin/fmriprep&quot;, line 5, in &lt;module&gt;
    from fmriprep.cli.run import main
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/fmriprep/cli/run.py&quot;, line 25, in &lt;module&gt;
    from .. import config
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/fmriprep/config.py&quot;, line 94, in &lt;module&gt;
    from templateflow.conf import TF_LAYOUT
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/templateflow/__init__.py&quot;, line 42, in &lt;module&gt;
    from . import api
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/templateflow/api.py&quot;, line 30, in &lt;module&gt;
    from templateflow.conf import (
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/templateflow/conf/__init__.py&quot;, line 56, in &lt;module&gt;
    _init_cache()
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/templateflow/conf/__init__.py&quot;, line 53, in _init_cache
    _update_s3(TF_HOME, local=True, overwrite=True)
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/templateflow/conf/_s3.py&quot;, line 41, in update
    retval = _update_skeleton(skel_file, dest, overwrite=overwrite, silent=silent)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/site-packages/templateflow/conf/_s3.py&quot;, line 81, in _update_skeleton
    dest.mkdir(exist_ok=True, parents=True)
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/pathlib.py&quot;, line 1120, in mkdir
    self.parent.mkdir(parents=True, exist_ok=True)
  File &quot;/opt/conda/envs/fmriprep/lib/python3.11/pathlib.py&quot;, line 1116, in mkdir
    os.mkdir(self, mode)
FileExistsError: [Errno 17] File exists: &#39;/home/ubuntu/.cache&#39;
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">CalledProcessError</span><span class="g g-Whitespace">                        </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">get_ipython</span><span class="p">()</span><span class="o">.</span><span class="n">run_cell_magic</span><span class="p">(</span><span class="s1">&#39;bash&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;# set up environment variables</span><span class="se">\n</span><span class="s1">export SUBJECTS_DIR=$PWD/fmriprep-freesurfer-dir</span><span class="se">\n</span><span class="s1">export APPTAINERENV_SUBJECTS_DIR=$SUBJECTS_DIR</span><span class="se">\n</span><span class="s1">export ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS=2 </span><span class="se">\n</span><span class="s1">export MPLCONFIGDIR=~/matplotlib-mpldir </span><span class="se">\n\n</span><span class="s1"># create subjects directory</span><span class="se">\n</span><span class="s1">mkdir -p $SUBJECTS_DIR</span><span class="se">\n\n</span><span class="s1"># run fmriprep</span><span class="se">\n</span><span class="s1">fmriprep ds000102/ fmriprep-output participant </span><span class="se">\\\n</span><span class="s1">--fs-license-file ~/.license </span><span class="se">\\\n</span><span class="s1">--output-spaces T1w MNI152NLin2009cAsym fsaverage fsnative </span><span class="se">\\\n</span><span class="s1">--participant-label 08 </span><span class="se">\\\n</span><span class="s1">--nprocs $ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS </span><span class="se">\\\n</span><span class="s1">--mem 10000 </span><span class="se">\\\n</span><span class="s1">--skip_bids_validation </span><span class="se">\\\n</span><span class="s1">--fs-subjects-dir $SUBJECTS_DIR </span><span class="se">\\\n</span><span class="s1">-v</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/IPython/core/interactiveshell.py:2517,</span> in <span class="ni">InteractiveShell.run_cell_magic</span><span class="nt">(self, magic_name, line, cell)</span>
<span class="g g-Whitespace">   </span><span class="mi">2515</span> <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">2516</span>     <span class="n">args</span> <span class="o">=</span> <span class="p">(</span><span class="n">magic_arg_s</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">2517</span>     <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2519</span> <span class="c1"># The code below prevents the output from being displayed</span>
<span class="g g-Whitespace">   </span><span class="mi">2520</span> <span class="c1"># when using magics with decorator @output_can_be_silenced</span>
<span class="g g-Whitespace">   </span><span class="mi">2521</span> <span class="c1"># when the last Python token in the expression is a &#39;;&#39;.</span>
<span class="g g-Whitespace">   </span><span class="mi">2522</span> <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="n">magic</span><span class="o">.</span><span class="n">MAGIC_OUTPUT_CAN_BE_SILENCED</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/IPython/core/magics/script.py:154,</span> in <span class="ni">ScriptMagics._make_script_magic.&lt;locals&gt;.named_script_magic</span><span class="nt">(line, cell)</span>
<span class="g g-Whitespace">    </span><span class="mi">152</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">153</span>     <span class="n">line</span> <span class="o">=</span> <span class="n">script</span>
<span class="ne">--&gt; </span><span class="mi">154</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">shebang</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

<span class="nn">File ~/.local/lib/python3.10/site-packages/IPython/core/magics/script.py:314,</span> in <span class="ni">ScriptMagics.shebang</span><span class="nt">(self, line, cell)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span> <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">raise_error</span> <span class="ow">and</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>     <span class="c1"># If we get here and p.returncode is still None, we must have</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>     <span class="c1"># killed it but not yet seen its return code. We don&#39;t wait for it,</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span>     <span class="c1"># in case it&#39;s stuck in uninterruptible sleep. -9 = SIGKILL</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>     <span class="n">rc</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">returncode</span> <span class="ow">or</span> <span class="o">-</span><span class="mi">9</span>
<span class="ne">--&gt; </span><span class="mi">314</span>     <span class="k">raise</span> <span class="n">CalledProcessError</span><span class="p">(</span><span class="n">rc</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>

<span class="ne">CalledProcessError</span>: Command &#39;b&#39;# set up environment variables\nexport SUBJECTS_DIR=$PWD/fmriprep-freesurfer-dir\nexport APPTAINERENV_SUBJECTS_DIR=$SUBJECTS_DIR\nexport ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS=2 \nexport MPLCONFIGDIR=~/matplotlib-mpldir \n\n# create subjects directory\nmkdir -p $SUBJECTS_DIR\n\n# run fmriprep\nfmriprep ds000102/ fmriprep-output participant \\\n--fs-license-file ~/.license \\\n--output-spaces T1w MNI152NLin2009cAsym fsaverage fsnative \\\n--participant-label 08 \\\n--nprocs $ITK_GLOBAL_DEFAULT_NUMBER_OF_THREADS \\\n--mem 10000 \\\n--skip_bids_validation \\\n--fs-subjects-dir $SUBJECTS_DIR \\\n-v\n&#39;&#39; returned non-zero exit status 1.
</pre></div>
</div>
</div>
</div>
</section>
<section id="fmriprep-results">
<h2>fMRIprep Results<a class="headerlink" href="#fmriprep-results" title="Permalink to this heading">#</a></h2>
<p>The full result report is in fmriprep-output/sub-08.html and you can open this webpage in Jupyterlab or in the browser. Here a few items from the report as an example and for a quick check:</p>
<section id="t1-and-brain-mask">
<h3>T1 and brain mask<a class="headerlink" href="#t1-and-brain-mask" title="Permalink to this heading">#</a></h3>
<p>Template T1-weighted image (if several T1w images were found), with contours delineating the detected brain mask and brain tissue segmentations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fmriprep-output/sub-08/figures/sub-08_dseg.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d41b16122c68057bd22f531d0fedd2a6838a98c72d714ba79caf0d6a845f2813.svg" src="_images/d41b16122c68057bd22f531d0fedd2a6838a98c72d714ba79caf0d6a845f2813.svg" /></div>
</div>
</section>
<section id="surfaces">
<h3>Surfaces<a class="headerlink" href="#surfaces" title="Permalink to this heading">#</a></h3>
<p>Surfaces (white and pial) reconstructed with FreeSurfer (recon-all) overlaid on the participant’s T1w template.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fmriprep-output/sub-08/figures/sub-08_desc-reconall_T1w.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2c0c9f44e2d5c19fa4fc09d270c3a7a934ec2607acfc8d9f526bbbae24716820.svg" src="_images/2c0c9f44e2d5c19fa4fc09d270c3a7a934ec2607acfc8d9f526bbbae24716820.svg" /></div>
</div>
</section>
<section id="epi-space-to-t1-space">
<h3>EPI-space to T1-space<a class="headerlink" href="#epi-space-to-t1-space" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fmriprep-output/sub-08/figures/sub-08_task-flanker_run-1_desc-coreg_bold.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/907abf4c60211d8654c79519700cd37d67f14d47ea345f7b45cfec638c789b7a.svg" src="_images/907abf4c60211d8654c79519700cd37d67f14d47ea345f7b45cfec638c789b7a.svg" /></div>
</div>
</section>
</section>
<section id="brain-mask-and-anatomical-temporal-compcor-rois">
<h2>Brain mask and (anatomical/temporal) CompCor ROIs<a class="headerlink" href="#brain-mask-and-anatomical-temporal-compcor-rois" title="Permalink to this heading">#</a></h2>
<p>Brain mask calculated on the BOLD signal (red contour), along with the regions of interest (ROIs) used for the estimation of physiological and movement confounding components that can be then used as nuisance regressors in analysis.
The anatomical CompCor ROI (magenta contour) is a mask combining CSF and WM (white-matter), where voxels containing a minimal partial volume of GM have been removed.
The temporal CompCor ROI (blue contour) contains the top 2% most variable voxels within the brain mask.
The brain edge (or crown) ROI (green contour) picks signals outside but close to the brain, which are decomposed into 24 principal components.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fmriprep-output/sub-08/figures/sub-08_task-flanker_run-1_desc-rois_bold.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94cf6c08841979aedadea4d3a09a4fc5470137228c235a82465657f024800d2c.svg" src="_images/94cf6c08841979aedadea4d3a09a4fc5470137228c235a82465657f024800d2c.svg" /></div>
</div>
<section id="bold-summary">
<h3>Bold Summary<a class="headerlink" href="#bold-summary" title="Permalink to this heading">#</a></h3>
<p>Summary statistics are plotted, which may reveal trends or artifacts in the BOLD data. Global signals calculated within the whole-brain (GS), within the white-matter (WM) and within cerebro-spinal fluid (CSF) show the mean BOLD signal in their corresponding masks. DVARS and FD show the standardized DVARS and framewise-displacement measures for each time point.
A carpet plot shows the time series for all voxels within the brain mask, or if –cifti-output was enabled, all grayordinates. Voxels are grouped into cortical (dark/light blue), and subcortical (orange) gray matter, cerebellum (green) and white matter and CSF (red), indicated by the color map on the left-hand side.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">SVG</span>
<span class="n">SVG</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fmriprep-output/sub-08/figures/sub-08_task-flanker_run-1_desc-carpetplot_bold.svg&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/19244db9a9552a12133f41753e6a9f3a4ad4a707bc26c5c611268b8abc1f2464.svg" src="_images/19244db9a9552a12133f41753e6a9f3a4ad4a707bc26c5c611268b8abc1f2464.svg" /></div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#output-cpu-information">Output CPU information</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#run-fmriprep">Run fMRIprep</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fmriprep-results">fMRIprep Results</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t1-and-brain-mask">T1 and brain mask</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#surfaces">Surfaces</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#epi-space-to-t1-space">EPI-space to T1-space</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brain-mask-and-anatomical-temporal-compcor-rois">Brain mask and (anatomical/temporal) CompCor ROIs</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bold-summary">Bold Summary</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Neurodesk Team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>